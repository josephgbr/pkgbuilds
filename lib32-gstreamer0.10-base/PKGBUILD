# Maintainer: josephgbr <rafael.f.f1@gmail.com>

_pkgbase=gstreamer0.10-base
pkgname=lib32-${_pkgbase}
pkgver=0.10.36
pkgrel=3
pkgdesc="GStreamer Multimedia Framework Base plugin libraries (32 bit)"
arch=('x86_64')
license=('LGPL')
depends=("lib32-gstreamer0.10" 'lib32-orc' 'lib32-libxv' ${_pkgbase})
makedepends=('gcc-multilib' 'lib32-alsa-lib' 'cdparanoia' 'lib32-libvisual'
             'lib32-libvorbis' 'lib32-libtheora' 'lib32-pango' 'lib32-gtk3')
options=('!libtool' '!emptydirs')
url="http://gstreamer.freedesktop.org/"
source=(${url}/src/gst-plugins-base/gst-plugins-base-${pkgver}.tar.xz
        'fix-automake-1-13.patch')
sha256sums=('1fe45c3894903001d4d008b0713dab089f53726dcb5842d5b40c2595a984e64a'
            '5ca353b28cf70555cd9b124ec0a9acc2b75a48e0aefa37ff21b6686d216857c4')

build() {
  export CC='gcc -m32'
  export CXX='g++ -m32'
  export PKG_CONFIG_PATH='/usr/lib32/pkgconfig'
  
  cd "gst-plugins-base-${pkgver}"
  
  patch -p1 -i "$srcdir"/fix-automake-1-13.patch
    
  sed -i configure \
    -e 's#HAVE_QT=yes#HAVE_QT=no#g' \
    -e 's#HAVE_QT_GV=yes#HAVE_QT_GV=no#g'
  
  ./configure \
  	--prefix=/usr \
  	--sysconfdir=/etc \
  	--localstatedir=/var \
  	--disable-static \
  	--enable-experimental \
  	--with-package-name="GStreamer Base Plugins (Archlinux)" \
	--with-package-origin="http://www.archlinux.org/" \
	--libdir=/usr/lib32 \
	--enable-introspection=no \
	--disable-nls \
  	--disable-gnome_vfs \
	--disable-xvideo \
	--disable-x \
	--disable-xshm \
	--disable-gst-v4l \
	--disable-gtk-doc \
	--disable-ivorbis
	
	
	

  make
  sed -e 's/^SUBDIRS_EXT =.*/SUBDIRS_EXT =/' -i Makefile
}

package() {
  cd "gst-plugins-base-${pkgver}"
  make DESTDIR="${pkgdir}" install
  rm -rf "${pkgdir}"/usr/{bin,include,share}
}
